# 育児マイルストーン記録アプリ アプリ仕様書 (v1.1)

## 1. 概要

本ドキュメントは、育児マイルストーン記録アプリ「はじめてメモ ~First Steps~」のv1.1開発に向けた仕様を定義するものです。v1.0 (MVP) からの改善と機能追加を目的とします。

| 項目 | 内容 |
|:---|:---|
| **アプリ名** | はじめてメモ ~First Steps~ |
| **バージョン** | 1.1 |
| **コンセプト** | 「初めての瞬間」だけを、シンプルに、美しく記録する。遠くの家族とも簡単に共有できる、ミニマルな育児マイルストーン記録アプリ。 |

---

## 2. v1.1での追加・改善要件

前回のレビューに基づき、以下の機能追加と品質改善を行います。

### 2.1. 広告機能の実装 (マネタイズ)

無料版ユーザー向けに広告を導入し、収益化を図ります。

| 項目 | 仕様 |
|:---|:---|
| **広告プラットフォーム** | Google AdMob |
| **バナー広告** | - **配置場所:** ホーム画面、タイムライン画面、マイルストーン一覧画面の下部に常時表示。<br>- **サイズ:** アダプティブバナーを使用し、各デバイスの画面幅に最適化する。 |
| **インタースティシャル広告** | - **表示タイミング:** マイルストーンの記録を保存した直後。<br>- **表示頻度:** 3回に1回の頻度で表示し、ユーザー体験を過度に損なわないように配慮する。 |

### 2.2. Pro版機能の実装 (アプリ内課金)

買い切り型のPro版を導入し、追加機能を提供します。

| 項目 | 仕様 |
|:---|:---|
| **課金管理** | **RevenueCat** を使用し、iOS/Androidの課金処理を共通化する。 |
| **価格** | ¥480 (買い切り) |
| **Pro版で提供する機能** | 1. **広告の非表示:** アプリ内のすべての広告が非表示になる。<br>2. **複数人の子供登録:** 2人目以降の子供を登録・切り替え可能になる。<br>3. **クラウドバックアップ:** Firebase (Authentication, Firestore, Storage) を利用し、機種変更時にデータを復元できるようにする。<br>4. **カスタムマイルストーン:** テンプレートにない、独自の「初めて」を自由に追加できる。<br>5. **PDF/画像一括出力:** 記録したマイルストーンをまとめてPDFや画像として書き出せる。 |
| **UI/UX** | - 設定画面に「Pro版にアップグレード」の導線を設置。<br>- Pro版限定機能（例: 2人目の子供登録）をタップした際に、購入を促すダイアログを表示する。 |

### 2.3. 品質改善

#### 2.3.1. エラーハンドリングの強化

データベース操作や画像選択など、失敗する可能性のある処理に対して、堅牢なエラーハンドリングを実装します。

- **方針:** `try-catch` ブロックを使用して例外を捕捉する。
- **ユーザー通知:** エラー発生時には、`SnackBar` や `AlertDialog` を用いて、「画像の保存に失敗しました」のような分かりやすいメッセージをユーザーに提示する。

#### 2.3.2. 画像の最適化

アプリケーションのストレージ使用量を削減し、パフォーマンスを向上させるため、ユーザーが選択した画像を最適化します。

- **方針:** `image` パッケージを利用する。
- **仕様:** ユーザーが選択した画像は、保存前に以下の処理を行う。
    1. 長辺が **1024px** を超える場合は、アスペクト比を維持したままリサイズする。
    2. JPEG形式に変換し、品質を **85%** に設定して圧縮する。

---

## 3. 将来の拡張機能 (v1.2以降)

- **ダークモード対応:** OSの設定に連動するダークテーマを追加する。
- **多言語対応:** `flutter_localizations` を使用し、英語圏のユーザーにも対応する。
- **アニメーション:** 画面遷移やUI要素に、洗練されたアニメーションを追加し、ユーザー体験を向上させる。

---

## 4. 技術スタック (更新)

| 要素 | 選択 | 理由 |
|:---|:---|:---|
| **広告** | Google AdMob | Flutterとの親和性が高く、導入が容易。 |
| **アプリ内課金** | RevenueCat | iOS/Androidの課金処理を抽象化し、実装を簡素化。 |
| **画像処理** | image | 画像のリサイズ・圧縮機能を提供。 |
| **クラウドバックアップ** | Firebase (Auth, Firestore, Storage) | ユーザー認証とデータ/画像のバックアップ基盤として堅牢。 |
